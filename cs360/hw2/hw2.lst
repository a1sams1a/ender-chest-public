SQL> SELECT ProjectID, Location, Hours FROM PROJECT NATURAL JOIN (SELECT ProjectID, COUNT(EmployeeID) AS Workers, SUM(Hours) AS Hours FROM WORKS_ON GROUP BY ProjectID) ORDER BY Location, Workers;

PROJECTID            LOCATION                                                                                                                                                              HOURS                                                                                                                                                                                                                
-------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------                                                                                                                                                                                                                
SP300                Chicago                                                                                                                                                                 103                                                                                                                                                                                                                
SP230                Chicago                                                                                                                                                                 136                                                                                                                                                                                                                
SP206                Chicago                                                                                                                                                                 183                                                                                                                                                                                                                
SP310                Chicago                                                                                                                                                                 219                                                                                                                                                                                                                
SP408                Houston                                                                                                                                                                 145                                                                                                                                                                                                                
SP360                Houston                                                                                                                                                                 163                                                                                                                                                                                                                
SP330                Houston                                                                                                                                                                 268                                                                                                                                                                                                                
SP204                LA                                                                                                                                                                       80                                                                                                                                                                                                                
SP101                LA                                                                                                                                                                      205                                                                                                                                                                                                                
SP202                LA                                                                                                                                                                      232                                                                                                                                                                                                                

10 개의 행이 선택되었습니다.

SQL> SELECT ProjectID, Hours FROM (SELECT ProjectID, SUM(Hours) AS Hours FROM EMPLOYEE NATURAL JOIN WORKS_ON GROUP BY ProjectID HAVING AVG(Salary) > 4200 AND COUNT(EmployeeID) > 3) NATURAL JOIN PROJECT WHERE Location = 'Chicago';

PROJECTID                 HOURS                                                                                                                                                                                                                                                                                                                                                                                 
-------------------- ----------                                                                                                                                                                                                                                                                                                                                                                                 
SP230                       136                                                                                                                                                                                                                                                                                                                                                                                 
SP310                       219                                                                                                                                                                                                                                                                                                                                                                                 

SQL> CREATE TABLE DEPARTMENT (Name VARCHAR(30), NumOfEmployee INT);

테이블이 생성되었습니다.

SQL> INSERT INTO DEPARTMENT(Name, NumOfEmployee) (SELECT Department AS Name, COUNT(EmployeeID) AS NumOfEmployee FROM EMPLOYEE GROUP BY Department);

3 개의 행이 만들어졌습니다.

SQL> SELECT * FROM DEPARTMENT;

NAME                                                         NUMOFEMPLOYEE                                                                                                                                                                                                                                                                                                                                      
------------------------------------------------------------ -------------                                                                                                                                                                                                                                                                                                                                      
Research                                                                 6                                                                                                                                                                                                                                                                                                                                      
Development                                                              5                                                                                                                                                                                                                                                                                                                                      
Headquarter                                                              3                                                                                                                                                                                                                                                                                                                                      

SQL> UPDATE EMPLOYEE SET Salary = Salary * 1.05 WHERE EmployeeID IN (SELECT EmployeeID FROM WORKS_ON NATURAL JOIN PROJECT WHERE Location = 'LA');

9 행이 갱신되었습니다.

SQL> SELECT Name, Salary FROM EMPLOYEE;

NAME                               SALARY                                                                                                                                                                                                                                                                                                                                                                       
------------------------------ ----------                                                                                                                                                                                                                                                                                                                                                                       
Rachel                               4500                                                                                                                                                                                                                                                                                                                                                                       
Andrew                               6300                                                                                                                                                                                                                                                                                                                                                                       
Brian                                5355                                                                                                                                                                                                                                                                                                                                                                       
Victoria                             4095                                                                                                                                                                                                                                                                                                                                                                       
Dave                                 3885                                                                                                                                                                                                                                                                                                                                                                       
Stella                               4500                                                                                                                                                                                                                                                                                                                                                                       
Monica                               5250                                                                                                                                                                                                                                                                                                                                                                       
Brando                               3990                                                                                                                                                                                                                                                                                                                                                                       
Brian                                4830                                                                                                                                                                                                                                                                                                                                                                       
Monica                               6500                                                                                                                                                                                                                                                                                                                                                                       
Diana                                4305                                                                                                                                                                                                                                                                                                                                                                       

NAME                               SALARY                                                                                                                                                                                                                                                                                                                                                                       
------------------------------ ----------                                                                                                                                                                                                                                                                                                                                                                       
John                                 4500                                                                                                                                                                                                                                                                                                                                                                       
Smith                                6500                                                                                                                                                                                                                                                                                                                                                                       
Mike                                 5145                                                                                                                                                                                                                                                                                                                                                                       

14 개의 행이 선택되었습니다.

SQL> SELECT DEPARTMENT.Name AS DEPARTMENT, EMPLOYEE.Name FROM DEPARTMENT LEFT OUTER JOIN EMPLOYEE ON DEPARTMENT.Name = EMPLOYEE.Department AND EMPLOYEE.Manager = 'YES';

DEPARTMENT                                                   NAME                                                                                                                                                                                                                                                                                                                                               
------------------------------------------------------------ ------------------------------                                                                                                                                                                                                                                                                                                                     
Headquarter                                                  Smith                                                                                                                                                                                                                                                                                                                                              
Development                                                  Mike                                                                                                                                                                                                                                                                                                                                               
Research                                                                                                                                                                                                                                                                                                                                                                                                        

SQL> SPOOL off
